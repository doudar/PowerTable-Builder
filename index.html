<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SmartSpin2k PowerTable Builder</title>
    <link rel="stylesheet" href="styles.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-dragdata@2.2.5/dist/chartjs-plugin-dragdata.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-zoom@2.0.1/dist/chartjs-plugin-zoom.min.js"></script>
</head>
<body>
    <div class="app-container">
        <header class="app-header">
            <div class="header-title-container">
                <img src="./smartspin2k-header.png" alt="SmartSpin2k" class="header-logo-inline">
                <h1>SmartSpin2k PowerTable Builder</h1>
            </div>
            <p>Interactive Power Curve Editor</p>
        </header>

        <div class="toolbar">
            <div class="file-controls">
                <label for="file-upload" class="btn btn-primary">
                    Open .ptab File
                    <input type="file" id="file-upload" accept=".ptab" style="display: none;">
                </label>
                <button id="download-btn" class="btn btn-secondary">Save .ptab File</button>
            </div>
            
            <div class="editing-controls-toolbar">
                <button id="smart-fill-btn" class="btn btn-primary">
                    <span>‚ö°</span> SmartFill
                </button>
                <button id="resolve-conflicts-btn" class="btn btn-warning">
                    <span>üîß</span> Resolve Conflicts
                </button>
                <button id="smart-smooth-btn" class="btn btn-success">
                    <span>üìà</span> SmartSmooth
                </button>
                <button id="toggle-original-btn" class="btn btn-outline">
                    <span>üëª</span> Show Original
                </button>
                <button id="undo-btn" class="btn btn-outline" disabled>
                    <span>‚Ü∂</span> Undo
                </button>
                <button id="redo-btn" class="btn btn-outline" disabled>
                    <span>‚Ü∑</span> Redo
                </button>
                <div class="opacity-control" id="opacity-control" style="display: none;">
                    <label for="original-opacity">Original Opacity:</label>
                    <input type="range" id="original-opacity" min="10" max="100" value="37" step="5">
                    <span id="opacity-value">37%</span>
                </div>
            </div>
            
            <div class="settings-controls">
                <div class="resistance-control">
                    <label for="max-resistance">Max Resistance:</label>
                    <input type="number" id="max-resistance" value="32029" min="1000" max="50000" step="1">
                    <span>Watts</span>
                </div>
                
                <div class="multiplier-control">
                    <label for="table-multiplier">Table Multiplier:</label>
                    <input type="number" id="table-multiplier" value="10" min="1" max="100" step="1">
                    <span>x</span>
                </div>
            </div>
        </div>

        <div class="main-content">
            <div class="chart-container">
                <div class="chart-zoom-controls">
                    <button id="zoom-in-btn" class="zoom-btn" title="Zoom In">üîç+</button>
                    <button id="zoom-out-btn" class="zoom-btn" title="Zoom Out">üîç-</button>
                    <button id="reset-zoom-btn" class="zoom-btn" title="Reset Zoom">‚åÇ</button>
                </div>
                <canvas id="power-chart"></canvas>
            </div>
            
            <div class="chart-controls">
                <div class="cadence-buttons" id="cadence-buttons">
                    <!-- Cadence buttons will be dynamically generated -->
                </div>
                
                <div class="editing-controls">
                    <div class="active-point-editor" id="point-editor" style="display: none;">
                        <h4>Edit Point</h4>
                        <div class="point-details">
                            <label>Cadence: <span id="point-cadence"></span> RPM</label>
                            <label>Watts: <span id="point-watts"></span>W</label>
                            <label>Resistance: <input type="number" id="point-resistance" min="0" step="1"></label>
                        </div>
                        <div class="point-actions">
                            <button id="save-point" class="btn btn-primary btn-sm">Save</button>
                            <button id="delete-point" class="btn btn-danger btn-sm">Delete</button>
                            <button id="cancel-edit" class="btn btn-outline btn-sm">Cancel</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="status-bar">
            <span id="status-message">Ready - Upload a .ptab file to begin</span>
            <span id="active-cadence">No cadence selected</span>
        </div>
    </div>

    <script src="script.js"></script>
</body>
</html>
